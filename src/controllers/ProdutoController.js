// const Fabricante = require("../models/Fabricante");
const { update } = require("../models/Produto");
const Produto = require("../models/Produto");

module.exports = {
  async index(req, res) {
    const produtos = await Produto.findAll();
    return res.json(produtos);
  },

  async store(req, res) {
    const {
      codigo_produto,
      descricao,
      codigo_usuario,
      grupo_produto_id,
      fabricante_id,
      tributos_id,
      unidade_medida_id,
      subgrupoprodutoid,
      sub_grupo_id,
      imobilizado,
      reducao_icms,
      limite_desconto,
      aliquota_icms,
      aliquota_ipi,
      estoque_atual,
      estoque_minumo,
      estoque_maximo,
      preco_custo,
      preco_venda,
      preco_brasindice,
      perc_aumento,
      data_ult_compra,
      valor_ult_compra,
      data_ult_venda,
      valor_ult_venda,
      validade,
      fator,
      peso_liquido,
      peso_bruto,
      caracteristica,
      icms_ult_compra,
      data_primeira_venda,
      aliquota_pis_cofins,
      ativo,
      outros_valores,
      valor_unitario,
      preco_custo_venda,
      indice_agregado,
      aliquota_cofins,
      limite_acrescimo,
      nomeclatura_mercosul,
      base_icms_subs_ult_compra,
      vlr_icms_subs_ult_compra,
      giromedio,
      piscofins,
      dataultimaalteracao,
      localimagemproduto,
      observacoes,
      peso,
      medida,
      amperagem,
      norma,
      tipocorrente,
      modelo,
      numero_frabricacao,
      data_fabricacao,
      alimentacao,
      corrente_sem_carga,
      corrente_com_carga,
      dc_abertura,
      tensao_arco,
      corrente_saida,
      ciclo_trabalho,
      precovendaanterior,
      genero_id,
      produtotipoitem_id,
      cst_pis,
      cst_cofins,
      estoque_reserva,
      cst_pis_saida,
      cst_cofins_saida,
      aliquota_pis_cofins_saida,
      aliquota_cofins_saida,
      cst_ipi,
      piscofinstab437_id,
      natureza_operacao,
      inicio_promocao,
      fim_promocao,
      dataultimaatualizacaopreco,
      ippt,
      produto_entrega,
      markup,
      vendedor_altera_preco,
      numero_ultima_nota,
      data_inclusao,
      margem_lucro,
      markup_margem,
      aliquota_st,
      preco_custo_anterioir,
      outras_observacoes,
      taxa_embalagem,
      diferenca_icm_sn,
      taxa_embalagem_sn,
      frete_sn,
      diferenca_icm_soma_sub,
      taxa_embalagem_soma_sub,
      taxa_embalagem_p_v,
      frete_item_p_v,
      frete_soma_sub,
      frete_item,
      diferenca_icm,
      dataultimaatualizacaoprecocusto,
      nota_fiscal_id,
      qtd_ultima_compra,
      data_de_validade,
      codncm,
      cest,
      origem,
      referencia,
      fator_transferencia,
      tabelaservico_id,
      tabelaatividade_id,
      codorigem,
      precopromopor_periodo_qtd,
      qtdacionaprecopromocao,
      producaopropria,
      valorcustoproducao,
      postospremia,
      resgatepremia,
      produtocomvariacoes,
    } = req.body;

    if (!codigo_produto || !descricao || undefined || "") {
      return res.status(400).json({ error: "Campos obrigatorios" });
    }

    const produto = await Produto.create({
      codigo_produto,
      descricao,
      codigo_usuario,
      grupo_produto_id,
      fabricante_id,
      tributos_id,
      unidade_medida_id,
      subgrupoprodutoid,
      sub_grupo_id,
      imobilizado,
      reducao_icms,
      limite_desconto,
      aliquota_icms,
      aliquota_ipi,
      estoque_atual,
      estoque_minumo,
      estoque_maximo,
      preco_custo,
      preco_venda,
      preco_brasindice,
      perc_aumento,
      data_ult_compra,
      valor_ult_compra,
      data_ult_venda,
      valor_ult_venda,
      validade,
      fator,
      peso_liquido,
      peso_bruto,
      caracteristica,
      icms_ult_compra,
      data_primeira_venda,
      aliquota_pis_cofins,
      ativo,
      outros_valores,
      valor_unitario,
      preco_custo_venda,
      indice_agregado,
      aliquota_cofins,
      limite_acrescimo,
      nomeclatura_mercosul,
      base_icms_subs_ult_compra,
      vlr_icms_subs_ult_compra,
      giromedio,
      piscofins,
      dataultimaalteracao,
      localimagemproduto,
      observacoes,
      peso,
      medida,
      amperagem,
      norma,
      tipocorrente,
      modelo,
      numero_frabricacao,
      data_fabricacao,
      alimentacao,
      corrente_sem_carga,
      corrente_com_carga,
      dc_abertura,
      tensao_arco,
      corrente_saida,
      ciclo_trabalho,
      precovendaanterior,
      genero_id,
      produtotipoitem_id,
      cst_pis,
      cst_cofins,
      estoque_reserva,
      cst_pis_saida,
      cst_cofins_saida,
      aliquota_pis_cofins_saida,
      aliquota_cofins_saida,
      cst_ipi,
      piscofinstab437_id,
      natureza_operacao,
      inicio_promocao,
      fim_promocao,
      dataultimaatualizacaopreco,
      ippt,
      produto_entrega,
      markup,
      vendedor_altera_preco,
      numero_ultima_nota,
      data_inclusao,
      margem_lucro,
      markup_margem,
      aliquota_st,
      preco_custo_anterioir,
      outras_observacoes,
      taxa_embalagem,
      diferenca_icm_sn,
      taxa_embalagem_sn,
      frete_sn,
      diferenca_icm_soma_sub,
      taxa_embalagem_soma_sub,
      taxa_embalagem_p_v,
      frete_item_p_v,
      frete_soma_sub,
      frete_item,
      diferenca_icm,
      dataultimaatualizacaoprecocusto,
      nota_fiscal_id,
      qtd_ultima_compra,
      data_de_validade,
      codncm,
      cest,
      origem,
      referencia,
      fator_transferencia,
      tabelaservico_id,
      tabelaatividade_id,
      codorigem,
      precopromopor_periodo_qtd,
      qtdacionaprecopromocao,
      producaopropria,
      valorcustoproducao,
      postospremia,
      resgatepremia,
      produtocomvariacoes,
    });

    return res.json(produto);
  },

  async update(req, res) {
    const { produto_id } = req.params;
    const {
      codigo_produto,
      descricao,
      codigo_usuario,
      grupo_produto_id,
      fabricante_id,
      tributos_id,
      unidade_medida_id,
      subgrupoprodutoid,
      sub_grupo_id,
      imobilizado,
      reducao_icms,
      limite_desconto,
      aliquota_icms,
      aliquota_ipi,
      estoque_atual,
      estoque_minumo,
      estoque_maximo,
      preco_custo,
      preco_venda,
      preco_brasindice,
      perc_aumento,
      data_ult_compra,
      valor_ult_compra,
      data_ult_venda,
      valor_ult_venda,
      validade,
      fator,
      peso_liquido,
      peso_bruto,
      caracteristica,
      icms_ult_compra,
      data_primeira_venda,
      aliquota_pis_cofins,
      ativo,
      outros_valores,
      valor_unitario,
      preco_custo_venda,
      indice_agregado,
      aliquota_cofins,
      limite_acrescimo,
      nomeclatura_mercosul,
      base_icms_subs_ult_compra,
      vlr_icms_subs_ult_compra,
      giromedio,
      piscofins,
      dataultimaalteracao,
      localimagemproduto,
      observacoes,
      peso,
      medida,
      amperagem,
      norma,
      tipocorrente,
      modelo,
      numero_frabricacao,
      data_fabricacao,
      alimentacao,
      corrente_sem_carga,
      corrente_com_carga,
      dc_abertura,
      tensao_arco,
      corrente_saida,
      ciclo_trabalho,
      precovendaanterior,
      genero_id,
      produtotipoitem_id,
      cst_pis,
      cst_cofins,
      estoque_reserva,
      cst_pis_saida,
      cst_cofins_saida,
      aliquota_pis_cofins_saida,
      aliquota_cofins_saida,
      cst_ipi,
      piscofinstab437_id,
      natureza_operacao,
      inicio_promocao,
      fim_promocao,
      dataultimaatualizacaopreco,
      ippt,
      produto_entrega,
      markup,
      vendedor_altera_preco,
      numero_ultima_nota,
      data_inclusao,
      margem_lucro,
      markup_margem,
      aliquota_st,
      preco_custo_anterioir,
      outras_observacoes,
      taxa_embalagem,
      diferenca_icm_sn,
      taxa_embalagem_sn,
      frete_sn,
      diferenca_icm_soma_sub,
      taxa_embalagem_soma_sub,
      taxa_embalagem_p_v,
      frete_item_p_v,
      frete_soma_sub,
      frete_item,
      diferenca_icm,
      dataultimaatualizacaoprecocusto,
      nota_fiscal_id,
      qtd_ultima_compra,
      data_de_validade,
      codncm,
      cest,
      origem,
      referencia,
      fator_transferencia,
      tabelaservico_id,
      tabelaatividade_id,
      codorigem,
      precopromopor_periodo_qtd,
      qtdacionaprecopromocao,
      producaopropria,
      valorcustoproducao,
      postospremia,
      resgatepremia,
      produtocomvariacoes,
    } = req.body;

    const produto = await Produto.findByPk(produto_id);

    if (!produto) {
      return res.status(400).json({ error: "Produto n√£o encontrado" });
    }

    if (!codigo_produto || !descricao || undefined || "") {
      return res.status(400).json({ error: "Campos obrigatorios" });
    }

    await Produto.update(
      {
        codigo_produto,
        descricao,
        codigo_usuario,
        grupo_produto_id,
        fabricante_id,
        tributos_id,
        unidade_medida_id,
        subgrupoprodutoid,
        sub_grupo_id,
        imobilizado,
        reducao_icms,
        limite_desconto,
        aliquota_icms,
        aliquota_ipi,
        estoque_atual,
        estoque_minumo,
        estoque_maximo,
        preco_custo,
        preco_venda,
        preco_brasindice,
        perc_aumento,
        data_ult_compra,
        valor_ult_compra,
        data_ult_venda,
        valor_ult_venda,
        validade,
        fator,
        peso_liquido,
        peso_bruto,
        caracteristica,
        icms_ult_compra,
        data_primeira_venda,
        aliquota_pis_cofins,
        ativo,
        outros_valores,
        valor_unitario,
        preco_custo_venda,
        indice_agregado,
        aliquota_cofins,
        limite_acrescimo,
        nomeclatura_mercosul,
        base_icms_subs_ult_compra,
        vlr_icms_subs_ult_compra,
        giromedio,
        piscofins,
        dataultimaalteracao,
        localimagemproduto,
        observacoes,
        peso,
        medida,
        amperagem,
        norma,
        tipocorrente,
        modelo,
        numero_frabricacao,
        data_fabricacao,
        alimentacao,
        corrente_sem_carga,
        corrente_com_carga,
        dc_abertura,
        tensao_arco,
        corrente_saida,
        ciclo_trabalho,
        precovendaanterior,
        genero_id,
        produtotipoitem_id,
        cst_pis,
        cst_cofins,
        estoque_reserva,
        cst_pis_saida,
        cst_cofins_saida,
        aliquota_pis_cofins_saida,
        aliquota_cofins_saida,
        cst_ipi,
        piscofinstab437_id,
        natureza_operacao,
        inicio_promocao,
        fim_promocao,
        dataultimaatualizacaopreco,
        ippt,
        produto_entrega,
        markup,
        vendedor_altera_preco,
        numero_ultima_nota,
        data_inclusao,
        margem_lucro,
        markup_margem,
        aliquota_st,
        preco_custo_anterioir,
        outras_observacoes,
        taxa_embalagem,
        diferenca_icm_sn,
        taxa_embalagem_sn,
        frete_sn,
        diferenca_icm_soma_sub,
        taxa_embalagem_soma_sub,
        taxa_embalagem_p_v,
        frete_item_p_v,
        frete_soma_sub,
        frete_item,
        diferenca_icm,
        dataultimaatualizacaoprecocusto,
        nota_fiscal_id,
        qtd_ultima_compra,
        data_de_validade,
        codncm,
        cest,
        origem,
        referencia,
        fator_transferencia,
        tabelaservico_id,
        tabelaatividade_id,
        codorigem,
        precopromopor_periodo_qtd,
        qtdacionaprecopromocao,
        producaopropria,
        valorcustoproducao,
        postospremia,
        resgatepremia,
        produtocomvariacoes,
      },
      {
        where: { produto_id: produto_id },
      }
    );

    return res.json(produto);
  },

    async delete(req, res) {
    const { produto_id } = req.params;
    const produto = await Produto.findByPk(produto_id);

    if (!produto) {
      return res.status(400).json({ error: "Produto n√£o encontrado" });
    }

    await produto.destroy(produto_id);
    return res.json();
  },
};
